var server = require('router').create();
var buffoon = require('buffoon');

var readings = {};
var content = {};
var port = process.argv[2] || 9000;

var table = "\nReading Timestamp,Bg,Meal Tag,Controlled\n\"Feb 20, 2012 15:11\",9.9,N,NO\n\"Feb 20, 2012 11:46\",8.1,N,NO\n\"Feb 20, 2012 10:19\",11.7,N,NO\n\"Feb 20, 2012 8:21\",7.8,N,NO\n\"Feb 20, 2012 1:35\",6.4,N,NO\n\"Feb 19, 2012 21:35\",11.4,N,NO\n\"Feb 19, 2012 17:05\",6.6,N,NO\n\"Feb 19, 2012 13:19\",12.5,N,NO\n\"Feb 19, 2012 0:02\",4.8,N,NO\n\"Feb 18, 2012 22:10\",8.3,N,NO\n\"Feb 18, 2012 21:08\",11.6,N,NO\n\"Feb 18, 2012 17:54\",8.8,N,NO\n\"Feb 18, 2012 16:04\",17.2,N,NO\n\"Feb 18, 2012 14:40\",12.3,N,NO\n\"Feb 18, 2012 10:34\",12.7,N,NO\n\"Feb 18, 2012 9:11\",13.5,N,NO\n\"Feb 18, 2012 8:44\",13.8,N,NO\n\"Feb 18, 2012 7:28\",17.5,N,NO\n\"Feb 18, 2012 5:32\",18.0,N,NO\n\"Feb 17, 2012 23:29\",23.7,N,NO\n\"Feb 17, 2012 18:08\",10.4,N,NO\n\"Feb 17, 2012 16:14\",8.1,N,NO\n\"Feb 17, 2012 13:21\",7.3,N,NO\n\"Feb 17, 2012 12:32\",12.2,N,NO\n\"Feb 17, 2012 10:30\",6.2,N,NO\n\"Feb 17, 2012 9:07\",17.7,N,NO\n\"Feb 17, 2012 1:24\",13.0,N,NO\n\"Feb 16, 2012 20:48\",8.7,N,NO\n\"Feb 16, 2012 16:40\",13.5,N,NO\n\"Feb 16, 2012 12:34\",10.1,N,NO\n\"Feb 16, 2012 7:56\",10.2,N,NO\n\"Feb 15, 2012 23:38\",5.9,N,NO\n\"Feb 15, 2012 21:39\",11.6,N,NO\n\"Feb 15, 2012 21:14\",13.2,N,NO\n\"Feb 15, 2012 20:45\",16.4,N,NO\n\"Feb 15, 2012 20:30\",20.3,N,NO\n\"Feb 15, 2012 20:14\",24.0,N,NO\n\"Feb 15, 2012 19:51\",21.3,N,NO\n\"Feb 15, 2012 19:26\",31.4,N,NO\n\"Feb 15, 2012 19:15\",29.4,N,NO\n\"Feb 15, 2012 18:51\",HI,N,NO\n\"Feb 15, 2012 18:45\",HI,N,NO\n\"Feb 15, 2012 18:38\",32.9,N,NO\n\"Feb 15, 2012 17:55\",HI,N,NO\n\"Feb 15, 2012 16:28\",HI,N,NO\n\"Feb 15, 2012 16:28\",31.3,N,NO\n\"Feb 15, 2012 13:08\",7.3,N,NO\n\"Feb 15, 2012 12:40\",6.2,N,NO\n\"Feb 15, 2012 12:16\",7.6,N,NO\n\"Feb 15, 2012 9:00\",3.9,N,NO\n\"Feb 15, 2012 7:07\",18.7,N,NO\n\"Feb 15, 2012 0:39\",7.0,N,NO\n\"Feb 15, 2012 0:12\",7.2,N,NO\n\"Feb 14, 2012 22:56\",3.5,N,NO\n\"Feb 14, 2012 18:18\",9.3,N,NO\n\"Feb 14, 2012 16:56\",12.2,N,NO\n\"Feb 14, 2012 15:26\",9.2,N,NO\n\"Feb 14, 2012 13:45\",7.9,N,NO\n\"Feb 14, 2012 11:55\",4.8,N,NO\n\"Feb 14, 2012 9:35\",4.9,N,NO\n\"Feb 14, 2012 8:24\",7.3,N,NO\n\"Feb 14, 2012 6:52\",12.4,N,NO\n\"Feb 13, 2012 23:51\",14.9,N,NO\n\"Feb 13, 2012 20:09\",4.7,N,NO\n\"Feb 13, 2012 15:58\",9.4,N,NO\n\"Feb 13, 2012 14:33\",10.2,N,NO\n\"Feb 13, 2012 13:26\",7.7,N,NO\n\"Feb 13, 2012 5:36\",10.5,N,NO\n\"Feb 12, 2012 23:30\",8.9,N,NO\n\"Feb 12, 2012 20:09\",13.0,N,NO\n\"Feb 12, 2012 17:36\",8.6,N,NO\n\"Feb 12, 2012 13:46\",4.7,N,NO\n\"Feb 12, 2012 10:09\",8.8,N,NO\n\"Feb 12, 2012 9:32\",10.1,N,NO\n\"Feb 12, 2012 1:09\",6.1,N,NO\n\"Feb 11, 2012 16:39\",3.9,N,NO\n\"Feb 11, 2012 9:10\",10.2,N,NO\n\"Feb 11, 2012 0:22\",5.7,N,NO\n\"Feb 10, 2012 14:08\",9.1,N,NO\n\"Feb 10, 2012 11:27\",4.5,N,NO\n\"Feb 10, 2012 7:00\",9.7,N,NO\n\"Feb 10, 2012 1:06\",7.9,N,NO\n\"Feb 09, 2012 21:40\",3.9,N,NO\n\"Feb 09, 2012 18:30\",7.4,N,NO\n\"Feb 09, 2012 16:28\",4.5,N,NO\n\"Feb 09, 2012 10:47\",11.7,N,NO\n\"Feb 09, 2012 9:24\",7.3,N,NO\n\"Feb 09, 2012 9:09\",8.0,N,NO\n\"Feb 08, 2012 20:26\",5.2,N,NO\n\"Feb 08, 2012 19:07\",9.3,N,NO\n\"Feb 08, 2012 11:23\",10.4,N,NO\n\"Feb 08, 2012 10:59\",10.8,N,NO\n\"Feb 08, 2012 7:47\",10.8,N,NO\n\"Feb 08, 2012 1:27\",8.8,N,NO\n\"Feb 07, 2012 23:27\",7.6,N,NO\n\"Feb 07, 2012 22:03\",7.1,N,NO\n\"Feb 07, 2012 19:35\",9.4,N,NO\n\"Feb 07, 2012 16:22\",8.1,N,NO\n\"Feb 07, 2012 15:31\",8.4,N,NO\n\"Feb 07, 2012 13:27\",8.1,N,NO\n\"Feb 07, 2012 11:29\",14.9,N,NO\n\"Feb 07, 2012 8:24\",9.5,N,NO\n\"Feb 07, 2012 2:01\",6.8,N,NO\n\"Feb 06, 2012 22:52\",15.4,N,NO\n\"Feb 06, 2012 19:54\",7.8,N,NO\n\"Feb 06, 2012 19:00\",5.7,N,NO\n\"Feb 06, 2012 14:43\",14.0,N,NO\n\"Feb 06, 2012 12:27\",8.8,N,NO\n\"Feb 06, 2012 8:22\",11.1,N,NO\n\"Feb 06, 2012 1:14\",3.9,N,NO\n\"Feb 05, 2012 20:19\",13.6,N,NO\n\"Feb 05, 2012 18:08\",4.8,N,NO\n\"Feb 05, 2012 15:22\",9.8,N,NO\n\"Feb 05, 2012 14:29\",8.9,N,NO\n\"Feb 05, 2012 11:11\",3.9,N,NO\n\"Feb 05, 2012 9:25\",9.6,N,NO\n\"Feb 05, 2012 7:54\",16.7,N,NO\n\"Feb 05, 2012 1:11\",6.8,N,NO\n\"Feb 04, 2012 23:15\",12.2,N,NO\n\"Feb 04, 2012 18:39\",10.1,N,NO\n\"Feb 04, 2012 16:19\",8.6,N,NO\n\"Feb 04, 2012 14:32\",10.6,N,NO\n\"Feb 04, 2012 11:42\",7.8,N,NO\n\"Feb 04, 2012 3:11\",7.7,N,NO\n\"Feb 04, 2012 2:44\",7.1,N,NO\n\"Feb 04, 2012 0:23\",12.9,N,NO\n\"Feb 03, 2012 21:12\",5.2,N,NO\n\"Feb 03, 2012 19:45\",6.0,N,NO\n\"Feb 03, 2012 19:30\",4.7,N,NO\n\"Feb 03, 2012 17:38\",13.7,N,NO\n\"Feb 03, 2012 12:59\",11.0,N,NO\n\"Feb 03, 2012 8:32\",8.2,N,NO\n\"Feb 03, 2012 1:24\",19.5,N,NO\n\"Feb 02, 2012 21:03\",3.2,N,NO\n\"Feb 02, 2012 19:28\",19.4,N,NO\n\"Feb 02, 2012 13:00\",3.6,N,NO\n\"Feb 02, 2012 8:06\",7.4,N,NO\n\"Feb 02, 2012 1:44\",15.7,N,NO\n\"Feb 01, 2012 18:49\",12.9,N,NO\n\"Feb 01, 2012 14:04\",5.1,N,NO\n\"Jan 31, 2012 18:47\",8.8,N,NO\n\"Jan 31, 2012 13:40\",9.1,N,NO\n\"Jan 31, 2012 10:51\",7.2,N,NO\n\"Jan 31, 2012 10:50\",9.2,N,NO\n\"Jan 31, 2012 8:05\",8.1,N,NO\n\"Jan 31, 2012 3:29\",10.9,N,NO\n\"Jan 31, 2012 2:27\",12.8,N,NO\n\"Jan 31, 2012 0:38\",13.9,N,NO\n\"Jan 30, 2012 20:27\",8.4,N,NO\n\"Jan 30, 2012 13:51\",14.5,N,NO\n\"Jan 30, 2012 11:47\",3.6,N,NO\n\"Jan 30, 2012 7:52\",5.8,N,NO\n\"Jan 30, 2012 5:02\",9.8,N,NO\n\"Jan 30, 2012 0:04\",10.1,N,NO\n\"Jan 29, 2012 20:10\",7.8,N,NO\n\"Jan 29, 2012 12:43\",17.1,N,NO\n\"Jan 29, 2012 8:41\",12.0,N,NO\n\"Jan 29, 2012 6:40\",14.5,N,NO\n\"Jan 29, 2012 4:36\",12.1,N,NO\n\"Jan 29, 2012 3:38\",16.4,N,NO\n\"Jan 29, 2012 3:09\",19.5,N,NO\n\"Jan 28, 2012 22:14\",8.2,N,NO\n\"Jan 28, 2012 14:29\",12.4,N,NO\n\"Jan 28, 2012 8:38\",13.5,N,NO\n\"Jan 28, 2012 5:36\",9.1,N,NO\n\"Jan 28, 2012 3:07\",8.2,N,NO\n\"Jan 28, 2012 2:13\",6.9,N,NO\n\"Jan 28, 2012 0:03\",13.5,N,NO\n\"Jan 27, 2012 22:50\",7.7,N,NO\n\"Jan 27, 2012 14:17\",8.5,N,NO\n\"Jan 27, 2012 13:35\",7.8,N,NO\n\"Jan 27, 2012 12:59\",8.4,N,NO\n\"Jan 27, 2012 11:03\",13.5,N,NO\n\"Jan 27, 2012 8:33\",8.7,N,NO\n\"Jan 27, 2012 6:58\",10.2,N,NO\n\"Jan 27, 2012 5:37\",3.6,N,NO\n\"Jan 27, 2012 3:51\",8.3,N,NO\n\"Jan 27, 2012 3:05\",12.8,N,NO\n\"Jan 27, 2012 1:22\",13.0,N,NO\n\"Jan 26, 2012 23:48\",12.8,N,NO\n\"Jan 26, 2012 22:16\",10.3,N,NO\n\"Jan 26, 2012 18:55\",6.8,N,NO\n\"Jan 26, 2012 13:10\",5.2,N,NO\n\"Jan 26, 2012 6:38\",8.3,N,NO\n\"Jan 26, 2012 2:16\",10.1,N,NO\n\"Jan 25, 2012 20:42\",12.4,N,NO\n\"Jan 25, 2012 12:23\",4.2,N,NO\n\"Jan 25, 2012 9:39\",5.3,N,NO\n\"Jan 25, 2012 6:08\",6.4,N,NO\n\"Jan 25, 2012 3:01\",4.4,N,NO\n\"Jan 25, 2012 0:55\",10.4,N,NO\n\"Jan 24, 2012 20:05\",11.7,N,NO\n\"Jan 24, 2012 11:40\",6.6,N,NO\n\"Jan 24, 2012 3:33\",13.4,N,NO\n\"Jan 23, 2012 23:47\",11.0,N,NO\n\"Jan 23, 2012 21:55\",3.1,N,NO\n\"Jan 23, 2012 19:09\",7.8,N,NO\n\"Jan 23, 2012 11:46\",7.6,N,NO\n\"Jan 23, 2012 9:34\",3.7,N,NO\n\"Jan 23, 2012 6:55\",11.0,N,NO\n\"Jan 23, 2012 3:04\",9.6,N,NO\n\"Jan 23, 2012 2:00\",6.8,N,NO\n\"Jan 23, 2012 1:36\",6.1,N,NO\n\"Jan 22, 2012 22:39\",5.0,N,NO\n\"Jan 22, 2012 18:39\",10.3,N,NO\n\"Jan 22, 2012 12:46\",19.6,N,NO\n\"Jan 22, 2012 9:06\",7.1,N,NO\n\"Jan 22, 2012 5:23\",5.7,N,NO\n\"Jan 22, 2012 2:38\",7.2,N,NO\n\"Jan 22, 2012 1:08\",7.8,N,NO\n\"Jan 21, 2012 20:27\",9.7,N,NO\n\"Jan 21, 2012 12:16\",8.2,N,NO\n\"Jan 21, 2012 10:39\",9.2,N,NO\n\"Jan 21, 2012 8:57\",6.1,N,NO\n\"Jan 21, 2012 8:07\",5.1,N,NO\n\"Jan 21, 2012 5:31\",6.1,N,NO\n\"Jan 21, 2012 5:14\",5.3,N,NO\n\"Jan 21, 2012 3:17\",6.2,N,NO\n\"Jan 20, 2012 23:25\",11.0,N,NO\n\"Jan 20, 2012 12:17\",7.6,N,NO\n\"Jan 20, 2012 5:29\",10.1,N,NO\n\"Jan 20, 2012 4:10\",3.2,N,NO\n\"Jan 20, 2012 0:58\",15.4,N,NO\n\"Jan 19, 2012 19:36\",6.4,N,NO\n\"Jan 19, 2012 14:13\",4.9,N,NO\n\"Jan 19, 2012 13:01\",8.7,N,NO\n\"Jan 19, 2012 11:44\",7.0,N,NO\n\"Jan 19, 2012 7:48\",4.2,N,NO\n\"Jan 19, 2012 6:02\",12.0,N,NO\n\"Jan 19, 2012 4:13\",13.8,N,NO\n\"Jan 19, 2012 0:35\",15.7,N,NO\n\"Jan 18, 2012 19:41\",10.8,N,NO\n\"Jan 18, 2012 11:23\",19.9,N,NO\n\"Jan 18, 2012 11:23\",30.3,N,NO\n\"Jan 18, 2012 8:24\",17.2,N,NO\n\"Jan 18, 2012 8:09\",14.1,N,NO\n\"Jan 18, 2012 6:29\",12.8,N,NO\n\"Jan 18, 2012 2:01\",15.0,N,NO\n\"Jan 18, 2012 0:00\",8.0,N,NO\n\"Jan 17, 2012 23:54\",16.0,N,NO\n\"Jan 17, 2012 20:26\",13.5,N,NO\n\"Jan 17, 2012 16:11\",12.1,N,NO\n\"Jan 17, 2012 14:17\",10.6,N,NO\n\"Jan 17, 2012 11:53\",9.8,N,NO\n\"Jan 17, 2012 9:55\",7.2,N,NO\n\"Jan 17, 2012 8:20\",6.1,N,NO\n\"Jan 17, 2012 1:54\",13.2,N,NO\n\"Jan 16, 2012 22:32\",6.6,N,NO\n\"Jan 16, 2012 19:32\",3.8,N,NO\n\"Jan 16, 2012 16:52\",9.6,N,NO\n\"Jan 16, 2012 14:16\",5.3,N,NO\n\"Jan 16, 2012 11:59\",11.9,N,NO\n\"Jan 16, 2012 9:21\",8.1,N,NO\n\"Jan 16, 2012 2:27\",5.3,N,NO\n\"Jan 15, 2012 21:00\",3.7,N,NO\n\"Jan 15, 2012 19:15\",8.9,N,NO\n\"Jan 15, 2012 17:56\",4.3,N,NO\n\"Jan 15, 2012 16:51\",7.4,N,NO\n\"Jan 15, 2012 13:21\",8.5,N,NO\n\"Jan 15, 2012 10:41\",5.3,N,NO\n\"Jan 15, 2012 8:24\",11.2,N,NO\n\"Jan 14, 2012 13:55\",3.7,N,NO\n\"Jan 14, 2012 11:12\",7.1,N,NO\n\"Jan 14, 2012 3:06\",12.4,N,NO\n\"Jan 13, 2012 19:24\",9.4,N,NO\n\"Jan 13, 2012 16:45\",2.8,N,NO\n\"Jan 13, 2012 14:59\",13.4,N,NO\n\"Jan 13, 2012 11:49\",6.9,N,NO\n\"Jan 13, 2012 9:16\",8.8,N,NO\n\"Jan 13, 2012 1:46\",3.9,N,NO\n\"Jan 12, 2012 23:46\",12.8,N,NO\n\"Jan 12, 2012 20:28\",3.8,N,NO\n\"Jan 12, 2012 19:04\",10.4,N,NO\n\"Jan 12, 2012 17:52\",9.7,N,NO\n\"Jan 12, 2012 13:42\",2.8,N,NO\n\"Jan 12, 2012 10:20\",12.2,N,NO\n\"Jan 12, 2012 8:20\",3.4,N,NO\n\"Jan 12, 2012 0:56\",7.1,N,NO\n\"Jan 11, 2012 23:20\",3.0,N,NO\n\"Jan 11, 2012 21:59\",7.8,N,NO\n\"Jan 11, 2012 20:05\",14.3,N,NO\n\"Jan 11, 2012 12:57\",3.1,N,NO\n\"Jan 11, 2012 11:56\",8.3,N,NO\n\"Jan 11, 2012 8:31\",10.6,N,NO\n\"Jan 11, 2012 0:59\",12.8,N,NO\n\"Jan 10, 2012 20:43\",7.1,N,NO\n\"Jan 10, 2012 18:02\",8.9,N,NO\n\"Jan 10, 2012 17:26\",6.7,N,NO\n\"Jan 10, 2012 14:54\",8.1,N,NO\n\"Jan 10, 2012 11:39\",5.4,N,NO\n\"Jan 10, 2012 7:47\",13.2,N,NO\n\"Jan 10, 2012 0:47\",11.2,N,NO\n\"Jan 09, 2012 22:40\",3.6,N,NO\n\"Jan 09, 2012 21:34\",5.0,N,NO\n\"Jan 09, 2012 20:20\",5.9,N,NO\n\"Jan 09, 2012 18:57\",5.9,N,NO\n\"Jan 09, 2012 15:36\",4.6,N,NO\n\"Jan 09, 2012 9:54\",8.3,N,NO\n\"Jan 09, 2012 8:42\",4.9,N,NO\n\"Jan 09, 2012 2:22\",6.1,N,NO\n\"Jan 09, 2012 1:06\",8.1,N,NO\n\"Jan 09, 2012 0:50\",7.9,N,NO\n\"Jan 08, 2012 22:09\",9.4,N,NO\n\"Jan 08, 2012 19:05\",4.4,N,NO\n\"Jan 08, 2012 17:48\",4.2,N,NO\n\"Jan 08, 2012 9:43\",4.8,N,NO\n\"Jan 08, 2012 2:50\",14.1,N,NO\n\"Jan 07, 2012 23:04\",3.3,N,NO\n\"Jan 07, 2012 20:14\",3.4,N,NO\n\"Jan 07, 2012 18:27\",4.4,N,NO\n\"Jan 07, 2012 16:55\",5.7,N,NO\n\"Jan 07, 2012 14:43\",4.3,N,NO\n\"Jan 07, 2012 10:12\",5.9,N,NO\n\"Jan 07, 2012 2:37\",8.5,N,NO\n\"Jan 07, 2012 1:25\",8.3,N,NO\n\"Jan 07, 2012 0:15\",3.7,N,NO\n\"Jan 06, 2012 20:36\",6.0,N,NO\n\"Jan 06, 2012 19:03\",6.3,N,NO\n\"Jan 06, 2012 13:37\",5.4,N,NO\n\"Jan 06, 2012 11:51\",4.2,N,NO\n\"Jan 06, 2012 9:09\",12.3,N,NO\n\"Jan 06, 2012 2:20\",8.5,N,NO\n\"Jan 05, 2012 21:02\",16.5,N,NO\n\"Jan 05, 2012 15:52\",14.6,N,NO\n\"Jan 05, 2012 14:00\",6.7,N,NO\n\"Jan 05, 2012 9:38\",17.1,N,NO\n\"Jan 05, 2012 3:08\",17.4,N,NO\n\"Jan 04, 2012 20:29\",6.2,N,NO\n\"Jan 04, 2012 18:38\",8.9,N,NO\n\"Jan 04, 2012 16:53\",20.2,N,NO\n\"Jan 04, 2012 10:38\",12.4,N,NO\n\"Jan 04, 2012 9:36\",9.3,N,NO\n\"Jan 04, 2012 3:05\",7.7,N,NO\n\"Jan 03, 2012 22:52\",2.8,N,NO\n\"Jan 03, 2012 22:03\",5.5,N,NO\n\"Jan 03, 2012 19:54\",4.2,N,NO\n\"Jan 03, 2012 18:06\",4.3,N,NO\n\"Jan 03, 2012 18:00\",4.3,N,NO\n\"Jan 03, 2012 15:41\",9.2,N,NO\n\"Jan 03, 2012 14:44\",10.3,N,NO\n\"Jan 03, 2012 13:41\",9.6,N,NO\n\"Jan 03, 2012 10:48\",11.6,N,NO\n\"Jan 03, 2012 8:04\",3.6,N,NO\n\"Jan 03, 2012 0:36\",15.5,N,NO\n\"Jan 02, 2012 22:54\",13.7,N,NO\n\"Jan 02, 2012 20:33\",16.4,N,NO\n\"Jan 02, 2012 17:38\",8.7,N,NO\n\"Jan 02, 2012 15:29\",9.8,N,NO\n\"Jan 02, 2012 15:04\",9.8,N,NO\n\"Jan 02, 2012 13:04\",11.3,N,NO\n\"Jan 02, 2012 12:31\",10.6,N,NO\n\"Jan 02, 2012 11:37\",12.0,N,NO\n\"Jan 02, 2012 11:11\",14.3,N,NO\n\"Jan 02, 2012 6:41\",13.7,N,NO\n\"Jan 01, 2012 22:31\",8.8,N,NO\n\"Jan 01, 2012 20:29\",15.0,N,NO\n\"Jan 01, 2012 16:34\",6.3,N,NO\n\"Jan 01, 2012 10:24\",5.3,N,NO\n\"Jan 01, 2012 2:49\",8.8,N,NO\n\"Jan 01, 2012 0:48\",13.9,N,NO\n\"Dec 31, 2011 23:36\",8.7,N,NO\n\"Dec 31, 2011 22:40\",7.2,N,NO\n\"Dec 31, 2011 21:34\",6.9,N,NO\n\"Dec 31, 2011 21:11\",5.2,N,NO\n\"Dec 31, 2011 20:46\",5.7,N,NO\n\"Dec 31, 2011 20:14\",7.5,N,NO\n\"Dec 31, 2011 19:54\",6.7,N,NO\n\"Dec 31, 2011 19:03\",7.3,N,NO\n\"Dec 31, 2011 18:08\",12.5,N,NO\n\"Dec 31, 2011 17:15\",12.6,N,NO\n\"Dec 31, 2011 16:20\",12.7,N,NO\n\"Dec 31, 2011 13:26\",17.5,N,NO\n\"Dec 31, 2011 5:14\",12.0,N,NO\n\"Dec 31, 2011 1:26\",13.5,N,NO\n\"Dec 31, 2011 1:19\",13.1,N,NO\n\"Dec 30, 2011 23:24\",13.2,N,NO\n\"Dec 30, 2011 21:32\",16.3,N,NO\n\"Dec 30, 2011 18:25\",7.7,N,NO\n\"Dec 30, 2011 16:54\",5.0,N,NO\n\"Dec 30, 2011 15:53\",6.2,N,NO\n\"Dec 30, 2011 13:37\",13.8,N,NO\n\"Dec 30, 2011 6:00\",13.6,N,NO\n\"Dec 30, 2011 4:51\",7.9,N,NO\n\"Dec 30, 2011 0:48\",6.7,N,NO\n\"Dec 29, 2011 22:25\",10.6,N,NO\n\"Dec 29, 2011 21:06\",11.7,N,NO\n\"Dec 29, 2011 19:15\",13.3,N,NO\n\"Dec 29, 2011 17:47\",8.4,N,NO\n\"Dec 29, 2011 14:48\",10.8,N,NO\n\"Dec 29, 2011 4:17\",5.3,N,NO\n\"Dec 29, 2011 1:02\",15.0,N,NO\n\"Dec 28, 2011 23:08\",9.9,N,NO\n\"Dec 28, 2011 22:02\",4.2,N,NO\n\"Dec 28, 2011 18:00\",8.1,N,NO\n\"Dec 28, 2011 16:39\",12.0,N,NO\n\"Dec 28, 2011 12:58\",17.9,N,NO\n\"Dec 28, 2011 5:18\",5.3,N,NO\n\"Dec 28, 2011 3:26\",14.7,N,NO\n\"Dec 28, 2011 2:18\",2.8,N,NO\n\"Dec 28, 2011 0:09\",14.5,N,NO\n\"Dec 27, 2011 22:12\",20.3,N,NO\n\"Dec 27, 2011 19:32\",4.9,N,NO\n\"Dec 27, 2011 16:43\",10.1,N,NO\n\"Dec 27, 2011 15:49\",7.1,N,NO\n\"Dec 27, 2011 12:44\",5.2,N,NO\n\"Dec 27, 2011 6:23\",6.9,N,NO\n\"Dec 27, 2011 5:09\",7.8,N,NO\n\"Dec 27, 2011 0:53\",7.9,N,NO\n\"Dec 26, 2011 22:00\",8.5,N,NO\n\"Dec 26, 2011 20:28\",9.9,N,NO\n\"Dec 26, 2011 17:23\",7.8,N,NO\n\"Dec 26, 2011 13:51\",16.8,N,NO\n\"Dec 26, 2011 3:47\",8.8,N,NO\n\"Dec 26, 2011 1:08\",12.1,N,NO\n\"Dec 26, 2011 0:32\",12.5,N,NO\n\"Dec 25, 2011 20:38\",4.6,N,NO\n\"Dec 25, 2011 14:54\",7.0,N,NO\n\"Dec 25, 2011 11:56\",15.7,N,NO\n\"Dec 25, 2011 6:04\",6.6,N,NO\n\"Dec 25, 2011 4:17\",21.6,N,NO\n\"Dec 25, 2011 1:03\",9.7,N,NO\n\"Dec 24, 2011 20:53\",4.4,N,NO\n\"Dec 24, 2011 19:04\",8.1,N,NO\n\"Dec 24, 2011 17:38\",3.6,N,NO\n\"Dec 24, 2011 17:17\",5.2,N,NO\n\"Dec 24, 2011 16:16\",5.8,N,NO\n\"Dec 24, 2011 14:53\",11.1,N,NO\n\"Dec 24, 2011 5:56\",13.3,N,NO\n\"Dec 24, 2011 1:27\",7.1,N,NO\n\"Dec 23, 2011 22:53\",6.3,N,NO\n\"Dec 23, 2011 21:00\",5.1,N,NO\n\"Dec 23, 2011 19:21\",5.1,N,NO\n\"Dec 23, 2011 17:26\",9.7,N,NO\n\"Dec 23, 2011 16:33\",4.8,N,NO\n\"Dec 23, 2011 13:18\",14.4,N,NO\n\"Dec 23, 2011 5:20\",10.5,N,NO\n\"Dec 23, 2011 1:33\",8.2,N,NO\n\"Dec 22, 2011 22:20\",7.8,N,NO\n\"Dec 22, 2011 19:31\",7.2,N,NO\n\"Dec 22, 2011 16:41\",7.4,N,NO\n\"Dec 22, 2011 11:59\",12.3,N,NO\n\"Dec 22, 2011 5:09\",8.4,N,NO\n\"Dec 22, 2011 2:42\",6.0,N,NO\n\"Dec 22, 2011 1:13\",8.6,N,NO\n\"Dec 21, 2011 23:55\",5.8,N,NO\n\"Dec 21, 2011 21:57\",6.3,N,NO\n\"Dec 21, 2011 21:03\",5.4,N,NO\n\"Dec 21, 2011 18:54\",9.4,N,NO\n\"Dec 21, 2011 17:10\",9.6,N,NO\n\"Dec 21, 2011 16:57\",9.8,N,NO\n\"Dec 21, 2011 16:42\",9.8,N,NO\n\"Dec 21, 2011 15:52\",2.7,N,NO\n\"Dec 21, 2011 12:40\",7.6,N,NO\n\"Dec 21, 2011 4:15\",4.2,N,NO\n\"Dec 20, 2011 22:50\",8.0,N,NO\n\"Dec 20, 2011 20:38\",3.3,N,NO\n\"Dec 20, 2011 18:52\",13.9,N,NO\n\"Dec 20, 2011 17:23\",9.7,N,NO\n\"Dec 20, 2011 14:12\",16.3,N,NO\n\"Dec 20, 2011 14:10\",15.8,N,NO\n\"Dec 20, 2011 0:34\",16.9,N,NO\n\"Dec 19, 2011 18:51\",9.7,N,NO\n\"Dec 19, 2011 14:13\",8.1,N,NO\n\"Dec 19, 2011 11:00\",7.8,N,NO\n\"Dec 19, 2011 4:47\",7.1,N,NO\n\"Dec 19, 2011 1:54\",12.8,N,NO\n\"Dec 19, 2011 0:54\",12.8,N,NO\n\"Dec 18, 2011 21:59\",9.9,N,NO\n\"Dec 18, 2011 17:15\",7.8,N,NO\n\"Dec 18, 2011 15:28\",10.4,N,NO\n\"Dec 18, 2011 12:23\",15.1,N,NO\n\"Dec 18, 2011 6:09\",12.0,N,NO\n\"Dec 18, 2011 3:41\",8.6,N,NO\n\"Dec 17, 2011 23:32\",7.7,N,NO\n\"Dec 17, 2011 21:09\",7.8,N,NO\n\"Dec 17, 2011 18:47\",4.8,N,NO\n\"Dec 17, 2011 18:19\",5.0,N,NO\n\"Dec 17, 2011 16:49\",8.9,N,NO\n\"Dec 17, 2011 16:26\",9.1,N,NO\n\"Dec 17, 2011 14:53\",11.9,N,NO\n\"Dec 17, 2011 10:42\",6.7,N,NO\n\"Dec 17, 2011 10:12\",7.7,N,NO\n\"Dec 17, 2011 9:06\",6.5,N,NO\n\"Dec 17, 2011 4:30\",5.9,N,NO\n\"Dec 17, 2011 3:06\",9.1,N,NO\n\"Dec 17, 2011 1:46\",14.8,N,NO\n\"Dec 16, 2011 23:47\",15.8,N,NO\n\"Dec 16, 2011 18:54\",4.0,N,NO\n\"Dec 16, 2011 18:25\",4.8,N,NO\n\"Dec 16, 2011 17:21\",12.8,N,NO\n\"Dec 16, 2011 16:19\",16.4,N,NO\n\"Dec 16, 2011 10:57\",6.1,N,NO\n\"Dec 16, 2011 8:44\",6.4,N,NO\n\"Dec 16, 2011 2:01\",9.3,N,NO\n\"Dec 15, 2011 18:58\",5.9,N,NO\n\"Dec 15, 2011 18:15\",4.9,N,NO\n\"Dec 15, 2011 16:37\",6.8,N,NO\n\"Dec 15, 2011 16:04\",8.1,N,NO\n\"Dec 15, 2011 14:33\",3.8,N,NO\n\"Dec 15, 2011 11:14\",14.4,N,NO\n\"Dec 15, 2011 7:07\",3.7,N,NO\n\"Dec 15, 2011 2:15\",5.9,N,NO\n\"Dec 15, 2011 0:16\",7.7,N,NO\n\"Dec 14, 2011 19:25\",11.8,N,NO\n\"Dec 14, 2011 18:52\",9.1,N,NO\n\"Dec 14, 2011 18:19\",3.3,N,NO\n\"Dec 14, 2011 16:21\",12.0,N,NO\n\"Dec 14, 2011 14:53\",12.5,N,NO\n\"Dec 14, 2011 11:47\",6.1,N,NO\n\"Dec 14, 2011 7:49\",9.2,N,NO\n\"Dec 14, 2011 1:13\",10.9,N,NO\n\"Dec 13, 2011 19:51\",6.3,N,NO\n\"Dec 13, 2011 19:03\",10.1,N,NO\n\"Dec 13, 2011 13:36\",9.3,N,NO\n\"Dec 13, 2011 12:56\",8.3,N,NO\n\"Dec 13, 2011 1:24\",7.9,N,NO\n\"Dec 13, 2011 0:13\",6.8,N,NO\n\"Dec 12, 2011 21:10\",2.8,N,NO\n\"Dec 12, 2011 19:25\",4.8,N,NO\n\"Dec 12, 2011 15:50\",9.6,N,NO\n\"Dec 12, 2011 14:08\",7.7,N,NO\n\"Dec 12, 2011 8:20\",4.1,N,NO\n\"Dec 12, 2011 0:29\",5.9,N,NO\n\"Dec 11, 2011 20:14\",15.0,N,NO\n\"Dec 11, 2011 18:12\",5.1,N,NO\n\"Dec 11, 2011 15:20\",9.5,N,NO\n\"Dec 11, 2011 13:48\",14.8,N,NO\n\"Dec 11, 2011 12:12\",14.0,N,NO\n\"Dec 11, 2011 10:15\",3.8,N,NO\n\"Dec 11, 2011 1:38\",11.0,N,NO\n\"Dec 10, 2011 21:59\",12.4,N,NO\n\"Dec 10, 2011 19:46\",7.9,N,NO\n\"Dec 10, 2011 17:21\",8.7,N,NO\n\"Dec 10, 2011 16:08\",5.5,N,NO\n\"Dec 10, 2011 14:03\",18.9,N,NO\n\"Dec 10, 2011 13:16\",11.2,N,NO\n\"Dec 10, 2011 2:53\",17.6,N,NO\n\"Dec 10, 2011 1:40\",15.5,N,NO\n\"Dec 10, 2011 0:56\",13.4,N,NO\n\"Dec 09, 2011 22:55\",6.8,N,NO\n\"Dec 09, 2011 17:58\",8.5,N,NO\n\"Dec 09, 2011 15:06\",8.7,N,NO\n\"Dec 09, 2011 8:33\",5.7,N,NO\n\"Dec 09, 2011 2:46\",15.0,N,NO\n\"Dec 08, 2011 19:42\",12.4,N,NO\n\"Dec 08, 2011 18:52\",11.1,N,NO\n\"Dec 08, 2011 17:36\",2.7,N,NO\n";

server.get('/', function(request, response) {
	response.writeHead(200, {'content-type':'application/json'});
	response.end(JSON.stringify(readings, null, '\t'));
});

server.get('/readings', function(request, response) {
	response.writeHead(200, {'content-type':'application/json'});

	var rows = content.split('\n');
	rows.shift();
	var map = rows.map(function(row) {
		var cell = row.split(',');
		return({
			timestamp: (cell[0] + ',' +cell[1]).replace(/"/g,''),
			bg: cell[2],
			mealTag: cell[3],
			controlled: cell[4]
		});
	});

	response.end(JSON.stringify(rows, null, '\t'));
});

server.post('/upload', function(request, response) {
	buffoon.json(request, function(err, data) {
		readings = data;
		if (data.Attachments) {
			content.readings = new Buffer(data.Attachments[0].Content, 'base64').toString('ascii');
		}

		response.writeHead(200);
		response.end('ok');
	});
});

server.all('*', function(request, response) {
	response.writeHead(404);
	response.end('404');
});

server.listen(port);
console.log('server running on port',port);

process.on('uncaughtException', function(err) { console.log(err.stack) });